<div class="container-fluid">
  <div class="row justify-content-center">
    <div class="col-lg-8 col-md-10">
      <div class="card shadow">
        <div class="card-header bg-warning text-white">
          <h3 class="card-title mb-0">
            <i class="fas fa-edit mr-2"></i>Edit Product
          </h3>
        </div>
        <div class="card-body">
          <div *ngIf="error" class="alert alert-danger" role="alert">
            <i class="fas fa-exclamation-triangle mr-2"></i>
            {{ error }}
          </div>

          <div *ngIf="loading" class="text-center py-5">
            <div class="spinner-border text-warning" role="status">
              <span class="sr-only">Loading...</span>
            </div>
            <p class="mt-2">Loading product...</p>
          </div>

          <form [formGroup]="productForm" (ngSubmit)="update()" *ngIf="!loading && product">
            <div class="row">
              <div class="col-md-6">
                <div class="form-group">
                  <label for="name" class="form-label">
                    <i class="fas fa-tag mr-1"></i>Product Name *
                  </label>
                  <input
                    formControlName="name"
                    type="text"
                    class="form-control"
                    placeholder="Enter product name"
                    id="name"
                    [class.is-invalid]="productForm.get('name')?.invalid && productForm.get('name')?.touched">
                  <div class="invalid-feedback" *ngIf="productForm.get('name')?.invalid && productForm.get('name')?.touched">
                    Product name is required.
                  </div>
                </div>
              </div>
              <div class="col-md-6">
                <div class="form-group">
                  <label for="price" class="form-label">
                    <i class="fas fa-dollar-sign mr-1"></i>Price *
                  </label>
                  <div class="input-group">
                    <div class="input-group-prepend">
                      <span class="input-group-text">$</span>
                    </div>
                    <input
                      formControlName="price"
                      type="number"
                      class="form-control"
                      placeholder="0.00"
                      id="price"
                      min="0"
                      step="0.01"
                      [class.is-invalid]="productForm.get('price')?.invalid && productForm.get('price')?.touched">
                    <div class="invalid-feedback" *ngIf="productForm.get('price')?.invalid && productForm.get('price')?.touched">
                      Please enter a valid price greater than 0.
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <div class="form-group">
              <label for="category" class="form-label">
                <i class="fas fa-folder mr-1"></i>Category *
              </label>
              <input
                type="text"
                formControlName="category"
                class="form-control"
                placeholder="Enter product category"
                id="category"
                [class.is-invalid]="productForm.get('category')?.invalid && productForm.get('category')?.touched">
              <div class="invalid-feedback" *ngIf="productForm.get('category')?.invalid && productForm.get('category')?.touched">
                Category is required.
              </div>
            </div>

            <div class="form-group">
              <label for="image" class="form-label">
                <i class="fas fa-image mr-1"></i>Product Image
              </label>
              <div class="custom-file">
                <input
                  formControlName="image"
                  (change)="handleUpload($event)"
                  type="file"
                  class="custom-file-input"
                  id="image"
                  accept="image/*">
                <label class="custom-file-label" for="image">
                  Choose new product image (optional)...
                </label>
              </div>
              <small class="form-text text-muted">Leave empty to keep current image. Supported formats: JPG, PNG, GIF. Max size: 5MB</small>
              <div *ngIf="file" class="mt-2">
                <img [src]="file" class="img-thumbnail" style="max-width: 200px; max-height: 200px;" alt="Current product image">
              </div>
            </div>

            <div class="form-group mt-4">
              <button type="submit" class="btn btn-warning btn-lg btn-block" [disabled]="loading || productForm.invalid">
                <span *ngIf="loading" class="spinner-border spinner-border-sm mr-2" role="status" aria-hidden="true"></span>
                <i class="fas fa-save mr-2" *ngIf="!loading"></i>
                {{ loading ? 'Updating Product...' : 'Update Product' }}
              </button>
            </div>
          </form>
        </div>
      </div>

      <div class="text-center mt-3">
        <a routerLink="/product-list" class="btn btn-outline-secondary">
          <i class="fas fa-arrow-left mr-2"></i>Back to Product List
        </a>
      </div>
    </div>
  </div>
</div>
